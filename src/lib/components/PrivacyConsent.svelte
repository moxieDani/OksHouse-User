<script>
	import { createEventDispatcher } from 'svelte';
	
	const dispatch = createEventDispatcher();
	
	let isAgreed = false;

	function handleConsent() {
		if (isAgreed) {
			dispatch('consent');
		}
	}

	function handleDecline() {
		dispatch('decline');
	}

	function handleOverlayClick(e) {
		// Prevent closing on overlay click
		e.preventDefault();
	}

	function handleKeydown(e) {
		// Prevent closing on escape
		if (e.key === 'Escape') {
			e.preventDefault();
		}
	}
</script>

<svelte:window on:keydown={handleKeydown} />

<div class="privacy-modal">
	<div class="privacy-overlay" on:click={handleOverlayClick} role="presentation"></div>
	<div class="privacy-content" role="dialog" aria-labelledby="privacy-title" aria-modal="true">
		<div class="privacy-header">
			<h2 id="privacy-title">ğŸ”’ ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš© ë™ì˜ì„œ</h2>
		</div>
		
		<div class="privacy-body">
			<div class="privacy-section">
				<h3>1. ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš© ëª©ì </h3>
				<p>Ok's HouseëŠ” ë‹¤ìŒì˜ ëª©ì ì„ ìœ„í•˜ì—¬ ê°œì¸ì •ë³´ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤:</p>
				<ul>
					<li>ë³„ì¥ ì˜ˆì•½ ì ‘ìˆ˜ ë° ì˜ˆì•½ í™•ì¸ ì•ˆë‚´</li>
					<li>ì˜ˆì•½ ë³€ê²½/ì·¨ì†Œ ë“± ì˜ˆì•½ ì´í–‰</li>
				</ul>
			</div>

			<div class="privacy-section">
				<h3>2. ìˆ˜ì§‘í•˜ëŠ” ê°œì¸ì •ë³´ í•­ëª©</h3>
				<div class="info-table">
					<div class="info-row">
						<div class="info-label">í•„ìˆ˜ì •ë³´</div>
						<div class="info-value">ì„±ëª…, íœ´ëŒ€í°ë²ˆí˜¸, ì˜ˆì•½ ë¹„ë°€ë²ˆí˜¸</div>
					</div>
				</div>
				<p><em>â€» ë³„ë„ì˜ ìë™ìˆ˜ì§‘(Log/IP, ì¿ í‚¤ ë“±)ì€ <strong>ìˆ˜ì§‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</strong>.</em></p>
			</div>

			<div class="privacy-section">
				<h3>3. ê°œì¸ì •ë³´ ë³´ìœ  ë° ì´ìš© ê¸°ê°„</h3>
				<ul>
					<li><strong>ì˜ˆì•½ì ì •ë³´:</strong> ìˆ˜ì§‘ì¼ë¡œë¶€í„° <strong>1ë…„ê°„ ë³´ìœ  í›„ ì¦‰ì‹œ íŒŒê¸°</strong></li>
				</ul>
				<p class="small-note"><em>ã€ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ ì‘ì„±ì§€ì¹¨(2025.4.)ã€</em>ì— ë”°ë¼ "ìˆ˜ì§‘ ëª©ì  ë° ìµœì†Œ ë³´ìœ  ê¸°ê°„"ì„ ëª…í™•íˆ ê¸°ì¬í•˜ì˜€ìŠµë‹ˆë‹¤</p>
				<p class="small-note"><a href="https://pipc.go.kr/np/cop/bbs/selectBoardArticle.do?bbsId=BS217&mCode=G010030000&nttId=11134&utm_source=chatgpt.com#LINK">ê°œì¸ì •ë³´ë³´í˜¸ìœ„ì›íšŒ ì°¸ì¡°</a></p>
			</div>

			<div class="privacy-section">
				<h3>4. ê°œì¸ì •ë³´ ì œ3ì ì œê³µ</h3>
				<p>Ok's HouseëŠ” ê³ ê°ì˜ ê°œì¸ì •ë³´ë¥¼ ì œ3ìì—ê²Œ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
			</div>

			<div class="privacy-section">
				<h3>5. ê°œì¸ì •ë³´ ì²˜ë¦¬ ìœ„íƒ</h3>
				<p>í˜„ì¬ ê°œì¸ì •ë³´ ì²˜ë¦¬ ê´€ë ¨ ì™¸ë¶€ ìœ„íƒì€ ì—†ìŠµë‹ˆë‹¤.</p>
			</div>

			<div class="privacy-section">
				<h3>6. ì •ë³´ì£¼ì²´ì˜ ê¶Œë¦¬ ë° í–‰ì‚¬ ë°©ë²•</h3>
				<p>ì •ë³´ì£¼ì²´ëŠ” ì–¸ì œë“ ì§€ ì•„ë˜ ê¶Œë¦¬ë¥¼ í–‰ì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
				<ul>
					<li>ê°œì¸ì •ë³´ ì—´ëŒ ìš”ì²­</li>
					<li>ê°œì¸ì •ë³´ ì •ì •Â·ì‚­ì œ ìš”ì²­</li>
					<li>ì²˜ë¦¬ì •ì§€ ìš”ì²­</li>
				</ul>
				<p class="contact-info">
					<strong>ë¬¸ì˜ì²˜:</strong> Ok's House ìš´ì˜ì<br>
					<strong>ì´ë©”ì¼:</strong> moxie2ks@gmail.com
				</p>
			</div>

			<div class="privacy-section important">
				<h3>âš ï¸ ìš´ì˜ ì•ˆë‚´</h3>
				<p>ë³¸ ìˆ™ì†ŒëŠ” <strong>ì¹œì¸ì²™ ë˜ëŠ” ì†Œìˆ˜ ì§€ì¸</strong>ì„ ëŒ€ìƒìœ¼ë¡œ ì œê³µë˜ëŠ” ë¹„ì˜ë¦¬ì  ê°œì¸ ìš´ì˜ì…ë‹ˆë‹¤.
				ì „ììƒê±°ë˜ë²•ìƒ 'ê±°ë˜ ê¸°ë¡ ë³´ê´€ 5ë…„' ì˜ë¬´ëŠ” <strong>ì ìš©ë˜ì§€ ì•ŠìŒ</strong>ì„ ì‚¬ì „ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.</p>
				<h3>âš ï¸ ë™ì˜ ê±°ë¶€ê¶Œ ë° ë¶ˆì´ìµ ì•ˆë‚´</h3>
				<p>ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš©ì— ëŒ€í•œ ë™ì˜ë¥¼ ê±°ë¶€í•  ê¶Œë¦¬ê°€ ìˆìŠµë‹ˆë‹¤.
				ë‹¤ë§Œ ë™ì˜í•˜ì§€ ì•Šì„ ê²½ìš°, ì˜ˆì•½ ì§„í–‰ì´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
			</div>
		</div>
		
		<div class="privacy-footer">
			<div class="consent-checkbox">
				<label for="privacy-agree">
					<input type="checkbox" id="privacy-agree" bind:checked={isAgreed}>
					<span class="checkbox-custom"></span>
					<span class="checkbox-text">ìœ„ ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤.</span>
				</label>
			</div>
			<div class="privacy-buttons">
				<button 
					class="btn-consent" 
					class:enabled={isAgreed}
					disabled={!isAgreed}
					on:click={handleConsent}
				>
					ë™ì˜í•˜ê³  ì˜ˆì•½ ì§„í–‰
				</button>
				<button class="btn-decline" on:click={handleDecline}>
					ë™ì˜í•˜ì§€ ì•ŠìŒ
				</button>
			</div>
		</div>
	</div>
</div>

<style>
	.privacy-modal {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: 1000;
		display: flex;
		align-items: center;
		justify-content: center;
		padding: var(--space-4);
	}

	.privacy-overlay {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background: rgba(0, 0, 0, 0.7);
		backdrop-filter: blur(4px);
	}

	.privacy-content {
		position: relative;
		background: white;
		border-radius: var(--radius-xl);
		box-shadow: var(--shadow-xl);
		max-width: 600px;
		max-height: 90vh;
		overflow: hidden;
		display: flex;
		flex-direction: column;
		width: 100%;
	}

	.privacy-header {
		padding: var(--space-6) var(--space-6) var(--space-4);
		border-bottom: 1px solid var(--neutral-200);
	}

	.privacy-header h2 {
		font-size: var(--text-xl);
		color: var(--primary);
		margin: 0;
		text-align: center;
	}

	.privacy-body {
		flex: 1;
		overflow-y: auto;
		padding: var(--space-4) var(--space-6);
	}

	.privacy-section {
		margin-bottom: var(--space-6);
	}

	.privacy-section h3 {
		font-size: var(--text-lg);
		color: var(--neutral-700);
		margin-bottom: var(--space-3);
	}

	.privacy-section p {
		margin-bottom: var(--space-3);
		line-height: 1.6;
		color: var(--neutral-600);
	}

	.privacy-section ul {
		margin-left: var(--space-4);
		margin-bottom: var(--space-3);
	}

	.privacy-section li {
		margin-bottom: var(--space-2);
		color: var(--neutral-600);
	}

	.info-table {
		background: var(--neutral-50);
		border-radius: var(--radius-md);
		padding: var(--space-4);
		margin-bottom: var(--space-3);
	}

	.info-row {
		display: flex;
		gap: var(--space-4);
	}

	.info-label {
		font-weight: 600;
		color: var(--neutral-700);
		min-width: 80px;
	}

	.info-value {
		color: var(--neutral-600);
	}

	.small-note {
		font-size: var(--text-sm);
		color: var(--neutral-500);
	}

	.small-note a {
		color: var(--primary);
		text-decoration: underline;
	}

	.contact-info {
		background: var(--neutral-50);
		padding: var(--space-4);
		border-radius: var(--radius-md);
		border-left: 4px solid var(--primary);
	}

	.important {
		background: rgba(245, 158, 11, 0.1);
		padding: var(--space-4);
		border-radius: var(--radius-md);
		border-left: 4px solid var(--warning);
	}

	.important h3 {
		color: var(--warning);
	}

	.privacy-footer {
		padding: var(--space-6);
		border-top: 1px solid var(--neutral-200);
		background: var(--neutral-50);
	}

	.consent-checkbox {
		margin-bottom: var(--space-4);
	}

	.consent-checkbox label {
		display: flex;
		align-items: center;
		cursor: pointer;
		font-size: var(--text-base);
		color: var(--neutral-700);
	}

	.consent-checkbox input[type="checkbox"] {
		position: absolute;
		opacity: 0;
		pointer-events: none;
	}

	.checkbox-custom {
		width: 20px;
		height: 20px;
		border: 2px solid var(--neutral-300);
		border-radius: var(--radius-sm);
		margin-right: var(--space-3);
		position: relative;
		transition: var(--transition-colors);
		flex-shrink: 0;
	}

	.consent-checkbox input[type="checkbox"]:checked + .checkbox-custom {
		background: var(--primary);
		border-color: var(--primary);
	}

	.consent-checkbox input[type="checkbox"]:checked + .checkbox-custom::after {
		content: 'âœ“';
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		color: white;
		font-size: 14px;
		font-weight: bold;
	}

	.checkbox-text {
		flex: 1;
	}

	.privacy-buttons {
		display: flex;
		gap: var(--space-3);
		justify-content: center;
		flex-wrap: wrap;
	}

	.btn-consent, .btn-decline {
		padding: var(--space-4) var(--space-6);
		border: none;
		border-radius: var(--radius-lg);
		font-size: var(--text-base);
		font-weight: 500;
		cursor: pointer;
		transition: var(--transition-colors), var(--transition-shadow), var(--transition-transform);
		font-family: inherit;
		min-height: 50px;
	}

	.btn-consent {
		background: var(--neutral-300);
		color: var(--neutral-600);
		cursor: not-allowed;
	}

	.btn-consent.enabled {
		background: linear-gradient(135deg, var(--success) 0%, #047857 100%);
		color: white;
		cursor: pointer;
		box-shadow: var(--shadow-md);
	}

	.btn-consent.enabled:hover {
		background: linear-gradient(135deg, #047857 0%, var(--success) 100%);
		box-shadow: var(--shadow-lg);
		transform: translateY(-2px);
	}

	.btn-decline {
		background: linear-gradient(135deg, var(--neutral-500) 0%, var(--neutral-600) 100%);
		color: white;
		box-shadow: var(--shadow-md);
	}

	.btn-decline:hover {
		background: linear-gradient(135deg, var(--neutral-600) 0%, var(--neutral-700) 100%);
		box-shadow: var(--shadow-lg);
		transform: translateY(-2px);
	}

	@media (max-width: 640px) {
		.privacy-modal {
			padding: var(--space-2);
		}

		.privacy-content {
			max-height: 95vh;
		}

		.privacy-header {
			padding: var(--space-4);
		}

		.privacy-body {
			padding: var(--space-3) var(--space-4);
		}

		.privacy-footer {
			padding: var(--space-4);
		}

		.privacy-buttons {
			flex-direction: column;
		}

		.btn-consent, .btn-decline {
			width: 100%;
		}
	}
</style>