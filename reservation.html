<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ˆì•½ - Ok's House</title>
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
            max-width: 600px;
            margin: 30px auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .step {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .step h3 {
            color: #3498db;
            margin-top: 0;
        }
        select, input {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .calendar-placeholder {
            width: 100%;
            height: 200px;
            border: 2px dashed #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            margin: 10px 0;
        }
        .btn {
            padding: 12px 30px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .btn:hover {
            background: #2980b9;
        }
        .btn-back {
            background: #95a5a6;
            margin-right: 10px;
        }
        .btn-back:hover {
            background: #7f8c8d;
        }
        .form-group {
            margin: 15px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .hidden {
            display: none;
        }
        .step-indicator {
            text-align: center;
            margin-bottom: 30px;
        }
        .step-dot {
            display: inline-block;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #ddd;
            color: white;
            line-height: 30px;
            margin: 0 5px;
            font-weight: bold;
        }
        .step-dot.active {
            background: #3498db;
        }
        .step-dot.completed {
            background: #27ae60;
        }
        .duration-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 10px 0;
        }
        .duration-btn {
            padding: 12px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        .duration-btn:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }
        .duration-btn.selected {
            border-color: #3498db;
            background: #3498db;
            color: white;
        }
        .calendar {
            border: 1px solid #ddd;
            border-radius: 5px;
            background: white;
            margin: 10px 0;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-bottom: 1px solid #ddd;
        }
        .calendar-nav {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 3px;
        }
        .calendar-nav:hover {
            background: #e9ecef;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
        }
        .calendar-day {
            padding: 10px;
            text-align: center;
            border: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .calendar-day:hover {
            background: #f8f9fa;
        }
        .calendar-day.disabled {
            color: #ccc;
            cursor: not-allowed;
        }
        .calendar-day.disabled:hover {
            background: white;
        }
        .calendar-day.selected {
            background: #3498db;
            color: white !important;
        }
        .calendar-day.in-range {
            background: #e3f2fd;
            color: #1976d2;
        }
        .calendar-day.saturday {
            color: #1565c0;
        }
        .calendar-day.sunday {
            color: #f44336;
        }
        .calendar-day.other-month {
            color: #bbb;
        }
        .calendar-day.other-month.disabled {
            color: #ddd;
        }
        .calendar-day.today {
            background: #fff3e0;
            border: 2px solid #ff9800;
            font-weight: bold;
        }
        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            background: #f8f9fa;
        }
        .calendar-weekday {
            padding: 10px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #f0f0f0;
            font-size: 12px;
        }
        .date-range-display {
            text-align: center;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 5px;
            font-weight: bold;
            color: #2c3e50;
            border: 2px solid #e9ecef;
        }
        .date-range-display.selected {
            background: #e3f2fd;
            border-color: #3498db;
            color: #1976d2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>â–¶ï¸ ì˜ˆì•½</h1>
        
        <!-- Step Indicator -->
        <div class="step-indicator">
            <span class="step-dot active" id="dot1">1</span>
            <span class="step-dot" id="dot2">2</span>
            <span class="step-dot" id="dot3">3</span>
        </div>
        
        <!-- Step 1: ìˆ™ë°• ê¸°ê°„ ì„ íƒ -->
        <div class="step" id="step1">
            <h3>1ë‹¨ê³„: ìˆ™ë°• ê¸°ê°„ ì„ íƒ</h3>
            <div class="form-group">
                <label>ìˆ™ë°• ê¸°ê°„:</label>
                <div class="duration-buttons">
                    <button class="duration-btn" onclick="selectDuration(1, this)">1ë°• 2ì¼</button>
                    <button class="duration-btn" onclick="selectDuration(2, this)">2ë°• 3ì¼</button>
                    <button class="duration-btn" onclick="selectDuration(3, this)">3ë°• 4ì¼</button>
                    <button class="duration-btn" onclick="selectDuration(4, this)">4ë°• 5ì¼</button>
                    <button class="duration-btn" onclick="selectDuration(5, this)">5ë°• 6ì¼</button>
                    <button class="duration-btn" onclick="selectDuration(6, this)">6ë°• 7ì¼</button>
                    <button class="duration-btn" onclick="selectDuration(7, this)">7ë°• 8ì¼</button>
                    <button class="duration-btn" onclick="selectDuration(8, this)">8ë°• 9ì¼</button>
                    <button class="duration-btn" onclick="selectDuration(9, this)">9ë°• 10ì¼</button>
                    <button class="duration-btn" onclick="selectDuration(10, this)">10ë°• 11ì¼</button>
                </div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-back" onclick="location.href='index.html'">ì´ì „</button>
                <button class="btn" onclick="nextStep(1)">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- Step 2: ë‹¬ë ¥ì—ì„œ ì‹œì‘ì¼ ì„ íƒ -->
        <div class="step hidden" id="step2">
            <h3>2ë‹¨ê³„: ì‹œì‘ì¼ ì„ íƒ</h3>
            
            <!-- ì„ íƒëœ ë‚ ì§œ ë²”ìœ„ í‘œì‹œ -->
            <div class="date-range-display" id="dateRangeDisplay">
                ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”
            </div>
            
            <div class="calendar">
                <div class="calendar-header">
                    <button class="calendar-nav" onclick="changeMonth(-1)">â€¹</button>
                    <span id="currentMonth"></span>
                    <button class="calendar-nav" onclick="changeMonth(1)">â€º</button>
                </div>
                <div class="calendar-weekdays">
                    <div class="calendar-weekday">ì¼</div>
                    <div class="calendar-weekday">ì›”</div>
                    <div class="calendar-weekday">í™”</div>
                    <div class="calendar-weekday">ìˆ˜</div>
                    <div class="calendar-weekday">ëª©</div>
                    <div class="calendar-weekday">ê¸ˆ</div>
                    <div class="calendar-weekday">í† </div>
                </div>
                <div class="calendar-grid" id="calendarGrid"></div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-back" onclick="prevStep(2)">ì´ì „</button>
                <button class="btn" id="nextBtn2" onclick="nextStep(2)" disabled style="opacity: 0.5; cursor: not-allowed;">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- Step 3: ì˜ˆì•½ì ì •ë³´ ì…ë ¥ -->
        <div class="step hidden" id="step3">
            <h3>3ë‹¨ê³„: ì˜ˆì•½ì ì •ë³´</h3>
            
            <!-- ì„ íƒëœ ì˜ˆì•½ ì •ë³´ í‘œì‹œ -->
            <div class="date-range-display selected" id="selectedReservationInfo">
                ì„ íƒëœ ì˜ˆì•½ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤
            </div>
            
            <div class="form-group">
                <label for="name">ì´ë¦„:</label>
                <input type="text" id="name" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
            </div>
            <div class="form-group">
                <label for="phone">ì „í™”ë²ˆí˜¸:</label>
                <input type="tel" id="phone" placeholder="010-1234-5678">
            </div>
            <div class="form-group">
                <label for="password">ë¹„ë°€ë²ˆí˜¸:</label>
                <input type="password" id="password" placeholder="ì˜ˆì•½ ì¡°íšŒ/ìˆ˜ì •ìš© ë¹„ë°€ë²ˆí˜¸">
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-back" onclick="prevStep(3)">ì´ì „</button>
                <button class="btn" onclick="completeReservation()">ì˜ˆì•½ ì™„ë£Œ</button>
            </div>
        </div>
    </div>

    <script>
        let selectedDuration = 0;
        let selectedStartDate = null;
        let currentDate = new Date();
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();

        // í˜ì´ì§€ ë¡œë“œì‹œ ë‹¬ë ¥ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            renderCalendar();
        });

        function selectDuration(days, button) {
            // ëª¨ë“  ë²„íŠ¼ì—ì„œ selected í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.duration-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // ì„ íƒëœ ë²„íŠ¼ì— selected í´ë˜ìŠ¤ ì¶”ê°€
            button.classList.add('selected');
            selectedDuration = days;
        }

        function nextStep(currentStep) {
            // í˜„ì¬ ìŠ¤í… ìœ íš¨ì„± ê²€ì‚¬
            if (currentStep === 1) {
                if (selectedDuration === 0) {
                    alert('ìˆ™ë°• ê¸°ê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
            } else if (currentStep === 2) {
                if (!selectedStartDate) {
                    alert('ì‹œì‘ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
            }
            
            // í˜„ì¬ ìŠ¤í… ìˆ¨ê¸°ê¸°
            document.getElementById('step' + currentStep).classList.add('hidden');
            document.getElementById('dot' + currentStep).classList.remove('active');
            document.getElementById('dot' + currentStep).classList.add('completed');
            
            // ë‹¤ìŒ ìŠ¤í… ë³´ì´ê¸°
            const nextStepNum = currentStep + 1;
            document.getElementById('step' + nextStepNum).classList.remove('hidden');
            document.getElementById('dot' + nextStepNum).classList.add('active');
            
            // 3ë‹¨ê³„ë¡œ ë„˜ì–´ê°ˆ ë•Œ ì„ íƒëœ ì˜ˆì•½ ì •ë³´ í‘œì‹œ
            if (nextStepNum === 3 && selectedStartDate && selectedDuration > 0) {
                updateStep3ReservationInfo();
            }
            // 2ë‹¨ê³„ë¡œ ëŒì•„ê°ˆ ë•Œ ì„ íƒëœ ë‚ ì§œë¡œ ë‹¬ë ¥ ì´ë” ë° ë²”ìœ„ í‘œì‹œ
            if (nextStepNum === 2 && selectedStartDate && selectedDuration > 0) {
                showSelectedDateRange();
            }
        }

        function prevStep(currentStep) {
            // í˜„ì¬ ìŠ¤í… ìˆ¨ê¸°ê¸°
            document.getElementById('step' + currentStep).classList.add('hidden');
            document.getElementById('dot' + currentStep).classList.remove('active');
            
            // ì´ì „ ìŠ¤í… ë³´ì´ê¸°
            const prevStepNum = currentStep - 1;
            document.getElementById('step' + prevStepNum).classList.remove('hidden');
            document.getElementById('dot' + prevStepNum).classList.remove('completed');
            document.getElementById('dot' + prevStepNum).classList.add('active');
            
            // Step 2ì—ì„œ ì´ì „ìœ¼ë¡œ ëŒì•„ê°ˆ ë•Œ ëª¨ë“  ì„ íƒ ì‚¬í•­ ì´ˆê¸°í™”
            if (currentStep === 2) {
                resetSelection();
                // í˜„ì¬ ë‹¬ë¡œ ëŒì•„ê°€ê¸°
                const today = new Date();
                currentMonth = today.getMonth();
                currentYear = today.getFullYear();
                renderCalendar();
            }
            // 3ë‹¨ê³„ì—ì„œ 2ë‹¨ê³„ë¡œ ëŒì•„ê°ˆ ë•Œ ì„ íƒëœ ë‚ ì§œë¡œ ì´ë™
            else if (currentStep === 3 && prevStepNum === 2) {
                showSelectedDateRange();
            }
        }

        function completeReservation() {
            // ì˜ˆì•½ì ì •ë³´ ìœ íš¨ì„± ê²€ì‚¬
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const password = document.getElementById('password').value;
            
            if (!name || !phone || !password) {
                alert('ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            alert('ì˜ˆì•½ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
            location.href = 'index.html';
        }

        function changeMonth(direction) {
            currentMonth += direction;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            
            // ë‹¬ë ¥ ë Œë”ë§ í›„ ì„ íƒ ìƒíƒœ ë³µì›
            if (selectedStartDate && selectedDuration > 0) {
                setTimeout(() => {
                    const endDate = new Date(selectedStartDate);
                    endDate.setDate(selectedStartDate.getDate() + selectedDuration);
                    restoreSelection(selectedStartDate, endDate);
                }, 50);
            }
        }

        function renderCalendar() {
            const monthNames = ["1ì›”", "2ì›”", "3ì›”", "4ì›”", "5ì›”", "6ì›”",
                              "7ì›”", "8ì›”", "9ì›”", "10ì›”", "11ì›”", "12ì›”"];
            
            document.getElementById('currentMonth').textContent = 
                `${currentYear}ë…„ ${monthNames[currentMonth]}`;
            
            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const firstDayOfWeek = firstDay.getDay();
            const daysInMonth = lastDay.getDate();
            
            // ì´ì „ ë‹¬ì˜ ë§ˆì§€ë§‰ ë‚ 
            const prevMonthLastDay = new Date(currentYear, currentMonth, 0).getDate();
            
            const calendarGrid = document.getElementById('calendarGrid');
            calendarGrid.innerHTML = '';
            
            // ì´ì „ ë‹¬ì˜ ë‚ ì§œë“¤
            for (let i = firstDayOfWeek - 1; i >= 0; i--) {
                const prevDate = prevMonthLastDay - i;
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day other-month';
                dayElement.textContent = prevDate;
                
                const prevMonthDate = new Date(currentYear, currentMonth - 1, prevDate);
                const today = new Date().setHours(0, 0, 0, 0);
                
                // ì˜¤ëŠ˜ ì´ì „ ë‚ ì§œëŠ” ë¹„í™œì„±í™” (ì£¼ë§ ìƒ‰ìƒë„ ì œê±°)
                if (prevMonthDate < today) {
                    dayElement.classList.add('disabled');
                } else {
                    // ì˜¤ëŠ˜ ì´í›„ ë‚ ì§œë§Œ ì£¼ë§ ìƒ‰ìƒ ì ìš©
                    const dayOfWeek = prevMonthDate.getDay();
                    if (dayOfWeek === 0) dayElement.classList.add('sunday');
                    if (dayOfWeek === 6) dayElement.classList.add('saturday');
                    
                    // í´ë¦­ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ê¸°
                    dayElement.onclick = () => selectStartDate(prevMonthDate, dayElement);
                }
                
                calendarGrid.appendChild(dayElement);
            }
            
            // í˜„ì¬ ë‹¬ì˜ ë‚ ì§œë“¤
            const today = new Date();
            const todayStr = today.setHours(0, 0, 0, 0);
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;
                
                const dayDate = new Date(currentYear, currentMonth, day);
                const dayOfWeek = dayDate.getDay();
                const dayStr = dayDate.setHours(0, 0, 0, 0);
                
                // ì˜¤ëŠ˜ ë‚ ì§œ í‘œì‹œ
                if (dayStr === todayStr) {
                    dayElement.classList.add('today');
                }
                
                // ì˜¤ëŠ˜ ì´ì „ ë‚ ì§œëŠ” ë¹„í™œì„±í™” (ì£¼ë§ ìƒ‰ìƒë„ ì œê±°)
                if (dayStr < todayStr) {
                    dayElement.classList.add('disabled');
                } else {
                    // ì˜¤ëŠ˜ ì´í›„ ë‚ ì§œë§Œ ì£¼ë§ ìƒ‰ìƒ ì ìš©
                    if (dayOfWeek === 0) dayElement.classList.add('sunday');
                    if (dayOfWeek === 6) dayElement.classList.add('saturday');
                    
                    dayElement.onclick = () => selectStartDate(dayDate, dayElement);
                }
                
                calendarGrid.appendChild(dayElement);
            }
            
            // ë‹¤ìŒ ë‹¬ì˜ ë‚ ì§œë“¤ (6ì£¼ ë‹¬ë ¥ì„ ìœ„í•´)
            const totalCells = 42; // 6ì£¼ Ã— 7ì¼
            const remainingCells = totalCells - (firstDayOfWeek + daysInMonth);
            
            for (let day = 1; day <= remainingCells; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day other-month';
                dayElement.textContent = day;
                
                const nextMonthDate = new Date(currentYear, currentMonth + 1, day);
                const dayOfWeek = nextMonthDate.getDay();
                const today = new Date().setHours(0, 0, 0, 0);
                
                // ì˜¤ëŠ˜ ì´ì „ ë‚ ì§œëŠ” ë¹„í™œì„±í™” (ì£¼ë§ ìƒ‰ìƒë„ ì œê±°)
                if (nextMonthDate < today) {
                    dayElement.classList.add('disabled');
                } else {
                    // ì˜¤ëŠ˜ ì´í›„ ë‚ ì§œë§Œ ì£¼ë§ ìƒ‰ìƒ ì ìš©
                    if (dayOfWeek === 0) dayElement.classList.add('sunday');
                    if (dayOfWeek === 6) dayElement.classList.add('saturday');
                    
                    // ë‹¤ìŒ ë‹¬ ë‚ ì§œë„ ì„ íƒ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ê¸°
                    dayElement.onclick = () => selectStartDate(nextMonthDate, dayElement);
                }
                
                calendarGrid.appendChild(dayElement);
            }
        }

        function selectStartDate(date, element) {
            // ê°™ì€ ë‚ ì§œë¥¼ ë‹¤ì‹œ í´ë¦­í•˜ë©´ ì„ íƒ í•´ì œ
            if (selectedStartDate && selectedStartDate.getTime() === date.getTime()) {
                resetSelection();
                return;
            }
            
            // ëª¨ë“  ë‚ ì§œì—ì„œ ì„ íƒ ìƒíƒœ ì œê±° (ì˜¤ëŠ˜ í‘œì‹œëŠ” ìœ ì§€)
            document.querySelectorAll('.calendar-day').forEach(day => {
                day.classList.remove('selected', 'in-range');
            });
            
            // ì˜¤ëŠ˜ ë‚ ì§œ í‘œì‹œ ë³µì›
            const today = new Date();
            const todayStr = today.setHours(0, 0, 0, 0);
            document.querySelectorAll('.calendar-day').forEach(day => {
                if (day.textContent && !day.classList.contains('disabled')) {
                    const dayNum = parseInt(day.textContent);
                    let dayDate;
                    
                    if (day.classList.contains('other-month')) {
                        if (dayNum > 15) {
                            dayDate = new Date(currentYear, currentMonth - 1, dayNum);
                        } else {
                            dayDate = new Date(currentYear, currentMonth + 1, dayNum);
                        }
                    } else {
                        dayDate = new Date(currentYear, currentMonth, dayNum);
                    }
                    
                    // ì˜¤ëŠ˜ ë‚ ì§œë©´ today í´ë˜ìŠ¤ ì¶”ê°€
                    if (dayDate && dayDate.setHours(0, 0, 0, 0) === todayStr) {
                        day.classList.add('today');
                    }
                }
            });
            
            selectedStartDate = date;
            element.classList.add('selected');
            
            // ì„ íƒëœ ë‚ ì§œì—ì„œ today í´ë˜ìŠ¤ ì œê±° (ì„ íƒ ìƒíƒœê°€ ìš°ì„ )
            element.classList.remove('today');
            
            // ë‹¤ìŒ ë²„íŠ¼ í™œì„±í™”
            enableNextButton();
            
            // ì„ íƒëœ ê¸°ê°„ë§Œí¼ ë‚ ì§œ ë²”ìœ„ í‘œì‹œ
            if (selectedDuration > 0) {
                const endDate = new Date(date);
                endDate.setDate(date.getDate() + selectedDuration);
                
                // ë‚ ì§œ ë²”ìœ„ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
                updateDateRangeDisplay(date, endDate);
                
                // ì‹œì‘ì¼ì´ ì´ì „ ë‹¬ì— ìˆìœ¼ë©´ ì´ì „ ë‹¬ë¡œ ì´ë™
                if (date.getMonth() !== currentMonth || date.getFullYear() !== currentYear) {
                    currentMonth = date.getMonth();
                    currentYear = date.getFullYear();
                    renderCalendar();
                    
                    // ë‹¬ë ¥ì„ ë‹¤ì‹œ ë Œë”ë§í•œ í›„ ì„ íƒ ìƒíƒœ ë³µì›
                    setTimeout(() => {
                        restoreSelection(date, endDate);
                    }, 50);
                    return;
                }
                // ì¢…ë£Œì¼ì´ ë‹¤ìŒ ë‹¬ì— ìˆìœ¼ë©´ ë‹¬ë ¥ì„ ë‹¤ìŒ ë‹¬ë¡œ ì´ë™
                else if (endDate.getMonth() !== currentMonth || endDate.getFullYear() !== currentYear) {
                    // ì¢…ë£Œì¼ì´ í˜„ì¬ ë‹¬ë ¥ì—ì„œ 2ì£¼ ì´ìƒ ë²—ì–´ë‚˜ë©´ ë‹¬ë ¥ ì´ë™
                    const currentMonthEnd = new Date(currentYear, currentMonth + 1, 0);
                    const daysFromMonthEnd = Math.ceil((endDate - currentMonthEnd) / (1000 * 60 * 60 * 24));
                    
                    if (daysFromMonthEnd > 7) {
                        // ë‹¤ìŒ ë‹¬ë¡œ ì´ë™
                        currentMonth = endDate.getMonth();
                        currentYear = endDate.getFullYear();
                        renderCalendar();
                        
                        // ë‹¬ë ¥ì„ ë‹¤ì‹œ ë Œë”ë§í•œ í›„ ì„ íƒ ìƒíƒœ ë³µì›
                        setTimeout(() => {
                            restoreSelection(date, endDate);
                        }, 50);
                        return;
                    }
                }
                
                // í˜„ì¬ ë‹¬ë ¥ì—ì„œ ë²”ìœ„ í‘œì‹œ
                highlightDateRange(date, endDate);
            }
        }

        function resetSelection() {
            // ì„ íƒ ìƒíƒœ ì´ˆê¸°í™”
            selectedStartDate = null;
            
            // ëª¨ë“  ë‚ ì§œì—ì„œ ì„ íƒ ìƒíƒœ ì œê±°
            document.querySelectorAll('.calendar-day').forEach(day => {
                day.classList.remove('selected', 'in-range');
            });
            
            // ì˜¤ëŠ˜ ë‚ ì§œ ë‹¤ì‹œ ê°•ì¡°í•˜ê¸°
            const today = new Date();
            const todayStr = today.setHours(0, 0, 0, 0);
            
            document.querySelectorAll('.calendar-day').forEach(day => {
                if (day.textContent && !day.classList.contains('disabled')) {
                    const dayNum = parseInt(day.textContent);
                    let dayDate;
                    
                    // í˜„ì¬ ë‹¬, ì´ì „ ë‹¬, ë‹¤ìŒ ë‹¬ ë‚ ì§œ êµ¬ë¶„
                    if (day.classList.contains('other-month')) {
                        if (dayNum > 15) {
                            dayDate = new Date(currentYear, currentMonth - 1, dayNum);
                        } else {
                            dayDate = new Date(currentYear, currentMonth + 1, dayNum);
                        }
                    } else {
                        dayDate = new Date(currentYear, currentMonth, dayNum);
                    }
                    
                    // ì˜¤ëŠ˜ ë‚ ì§œë©´ today í´ë˜ìŠ¤ ì¶”ê°€
                    if (dayDate.setHours(0, 0, 0, 0) === todayStr) {
                        day.classList.add('today');
                    }
                }
            });
            
            // ë‚ ì§œ ë²”ìœ„ í‘œì‹œ ì´ˆê¸°í™”
            const displayElement = document.getElementById('dateRangeDisplay');
            if (displayElement) {
                displayElement.textContent = 'ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';
                displayElement.classList.remove('selected');
            }
            
            // ë‹¤ìŒ ë²„íŠ¼ ë¹„í™œì„±í™”
            disableNextButton();
        }

        function enableNextButton() {
            const nextBtn = document.getElementById('nextBtn2');
            if (nextBtn) {
                nextBtn.disabled = false;
                nextBtn.style.opacity = '1';
                nextBtn.style.cursor = 'pointer';
            }
        }

        function disableNextButton() {
            const nextBtn = document.getElementById('nextBtn2');
            if (nextBtn) {
                nextBtn.disabled = true;
                nextBtn.style.opacity = '0.5';
                nextBtn.style.cursor = 'not-allowed';
            }
        }

        function updateDateRangeDisplay(startDate, endDate) {
            const displayElement = document.getElementById('dateRangeDisplay');
            if (displayElement) {
                const startStr = formatKoreanDate(startDate);
                const endStr = formatKoreanDate(endDate);
                displayElement.textContent = `${startStr} - ${endStr}`;
                displayElement.classList.add('selected');
            }
        }

        function formatKoreanDate(date) {
            return `${date.getFullYear()}ë…„ ${date.getMonth() + 1}ì›” ${date.getDate()}ì¼`;
        }
        
        function updateStep3ReservationInfo() {
            const infoElement = document.getElementById('selectedReservationInfo');
            if (infoElement && selectedStartDate && selectedDuration > 0) {
                const endDate = new Date(selectedStartDate);
                endDate.setDate(selectedStartDate.getDate() + selectedDuration);
                
                const startStr = formatKoreanDate(selectedStartDate);
                const endStr = formatKoreanDate(endDate);
                const durationText = `${selectedDuration}ë°• ${selectedDuration + 1}ì¼`;
                
                // ìš”ì¼ ì •ë³´ ì¶”ê°€
                const startDay = formatDayOfWeek(selectedStartDate);
                const endDay = formatDayOfWeek(endDate);
                
                infoElement.innerHTML = `
                    <div style="text-align: center; padding: 10px;">
                        <div style="font-size: 18px; font-weight: bold; color: #2c3e50; margin-bottom: 15px;">
                            ğŸ“… ì„ íƒëœ ì˜ˆì•½ ì •ë³´
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #3498db;">
                            <div style="margin-bottom: 10px;">
                                <strong style="color: #2c3e50;">ì²´í¬ì¸:</strong> 
                                <span style="color: #3498db; font-weight: bold;">${startStr} (${startDay})</span>
                            </div>
                            <div style="margin-bottom: 10px;">
                                <strong style="color: #2c3e50;">ì²´í¬ì•„ì›ƒ:</strong> 
                                <span style="color: #e74c3c; font-weight: bold;">${endStr} (${endDay})</span>
                            </div>
                            <div>
                                <strong style="color: #2c3e50;">ìˆ™ë°• ê¸°ê°„:</strong> 
                                <span style="color: #27ae60; font-weight: bold;">${durationText}</span>
                            </div>
                        </div>
                    </div>
                `;
            }
        }
        
        function formatDayOfWeek(date) {
            const days = ['ì¼ìš”ì¼', 'ì›”ìš”ì¼', 'í™”ìš”ì¼', 'ìˆ˜ìš”ì¼', 'ëª©ìš”ì¼', 'ê¸ˆìš”ì¼', 'í† ìš”ì¼'];
            return days[date.getDay()];
        }
        
        function showSelectedDateRange() {
            if (selectedStartDate && selectedDuration > 0) {
                // ì„ íƒëœ ì‹œì‘ì¼ì˜ ë‹¬ë¡œ ì´ë™
                currentMonth = selectedStartDate.getMonth();
                currentYear = selectedStartDate.getFullYear();
                renderCalendar();
                
                // ë‹¬ë ¥ ë Œë”ë§ í›„ ì„ íƒ ë²”ìœ„ í‘œì‹œ
                setTimeout(() => {
                    const endDate = new Date(selectedStartDate);
                    endDate.setDate(selectedStartDate.getDate() + selectedDuration);
                    
                    // ë‚ ì§œ ë²”ìœ„ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
                    updateDateRangeDisplay(selectedStartDate, endDate);
                    
                    // ë²”ìœ„ í‘œì‹œ
                    highlightDateRange(selectedStartDate, endDate);
                    
                    // ë‹¤ìŒ ë²„íŠ¼ í™œì„±í™”
                    enableNextButton();
                }, 50);
            }
        }

        function highlightDateRange(startDate, endDate) {
            // ëª¨ë“  ë‹¬ë ¥ ë‚ ì§œ ìš”ì†Œë“¤ì„ ìˆœíšŒí•˜ë©° ë²”ìœ„ ì²´í¬
            const allDays = document.querySelectorAll('.calendar-day');
            allDays.forEach(day => {
                if (day.textContent && !day.classList.contains('disabled')) {
                    const dayNum = parseInt(day.textContent);
                    let dayDate;
                    
                    // í˜„ì¬ ë‹¬, ì´ì „ ë‹¬, ë‹¤ìŒ ë‹¬ ë‚ ì§œ êµ¬ë¶„
                    if (day.classList.contains('other-month')) {
                        // ì´ì „ ë‹¬ ë‚ ì§œ (ì²« ì£¼)
                        if (dayNum > 15) {
                            dayDate = new Date(currentYear, currentMonth - 1, dayNum);
                        } 
                        // ë‹¤ìŒ ë‹¬ ë‚ ì§œ (ë§ˆì§€ë§‰ ì£¼)
                        else {
                            dayDate = new Date(currentYear, currentMonth + 1, dayNum);
                        }
                    } else {
                        // í˜„ì¬ ë‹¬ ë‚ ì§œ
                        dayDate = new Date(currentYear, currentMonth, dayNum);
                    }
                    
                    // ì‹œì‘ì¼ê³¼ ê°™ì€ ë‚ ì§œë©´ selected í´ë˜ìŠ¤ ì¶”ê°€
                    if (dayDate.getTime() === startDate.getTime()) {
                        day.classList.add('selected');
                    }
                    // ë²”ìœ„ ë‚´ì— ìˆëŠ”ì§€ í™•ì¸
                    else if (dayDate > startDate && dayDate <= endDate) {
                        day.classList.add('in-range');
                    }
                }
            });
        }

        function restoreSelection(startDate, endDate) {
            // ë‹¬ë ¥ ì´ë™ í›„ ì„ íƒ ìƒíƒœ ë³µì›
            highlightDateRange(startDate, endDate);
        }
    </script>
</body>
</html>